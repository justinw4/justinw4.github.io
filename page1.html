<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" type="text/css" href="main.css" />
        <script src = "d3.min.js"></script>
    </head>
    <body>
        <!-- Navigation Bar -->
        <div class="navbar">
            <div class="container">
                <ul>
                    <li><a href="index.html">Home</a></li>
                    <li><a href="page1.html">Page 1</a></li>
                    <li><a href="page2.html">Page 2</a></li>
                    <li><a href="page3.html">Page 3</a></li>
                </ul>
            </div>
        </div>

        <!-- Webpage Content -->
        <div class="sections">
            <div class="homerun-chart">
                <svg id="chart" width=1100 height=600></svg>
                <style> .myCircle:hover { stroke: black; fill: black; } </style>
                <script>
                    // Initialize Variables
                    var margin = 60;
                    var width = 1000;
                    var height = 500; 
                    
                    // Get the data
                    // data = await d3.csv("Homeruns.csv"); 
                    
                    var svg = d3.select("svg#chart").append("svg").attr("width", width).attr("height", height).append("g").attr("transform","translate("+margin+","+margin+")"); 
                    
                    var x = d3.scaleLinear().domain([1985,2020]).range([0,width]);
                    var y = d3.scaleLinear().domain([0,7000]).range([height,0]); 

                    var xAxis = d3.axisBottom(x).tickValues([1985,1990,1995,2000,2005,2010,2015,2020]).tickFormat(d3.format(".4r"));
                    var yAxis = d3.axisLeft(y).tickValues([0,1000,2000,3000,4000,5000,6000,7000]).tickFormat(d3.format(".4r"));

                    // Draw Axis
                    d3.select("svg").append("g").attr("transform","translate("+margin+","+margin+")").call(yAxis); 
                    d3.select("svg").append("g").attr("transform","translate("+margin+","+(height+margin)+")").call(xAxis); 

                    // Data
                    d3.csv("Homeruns.csv").then(function(data) {
                        // Line
                        svg.append("path").datum(data).attr("class","line").attr("fill","none").attr("stroke","lightcoral").attr("stroke-width",2)
                            .attr("d",d3.line().x(function(d) { return x(d.Year); }).y(function(d) { return y(d.Homeruns); })); 

                        // Tooltip
                        var Tooltip = svg.append("div").style("opacity", 0).attr("class", "tooltip").style("background-color", "lightblue")
                        .style("border", "solid").style("border-width", "2px").style("border-radius", "5px").style("padding", "5px").attr("z-index",5);

                        var mouseover = function(d) {
                            Tooltip.style("opacity", 1)
                        }

                        var mousemove = function(d) {
                            Tooltip.html("Year: " + d.Year + "\n" + "# of Homeruns: " + d.Homeruns).style("left", (d3.mouse(this)[0]+70) + "px").style("top", (d3.mouse(this)[1]) + "px")
                        }

                        var mouseleave = function(d) {
                            Tooltip.style("opacity", 0)
                        }
                        
                        // Individual data points
                        svg.append("g").selectAll("dot").data(data).enter().append("circle")
                            .attr("cx", function(d) { return x(d.Year) })
                            .attr("cy", function(d) { return y(d.Homeruns) })
                            .attr("r", 5)
                            .attr("stroke","lightcoral").attr("fill","lightcoral")
                            .on("mouseover", mouseover).on("mousemove", mousemove).on("mouseleave", mouseleave);

                        // Add title and labels to x axis and y axis
                        svg.append("text").attr("x", (width / 2)).attr("y", 0 - (margin / 2)).attr("text-anchor", "middle").style("font-size", "24px") 
                            .style("text-decoration", "bold").text("# of Homeruns vs Year Graph");

                        svg.append("text").attr("transform","translate("+(width/2)+","+(height+margin+20)+")").style("text-anchor", "middle").text("Year");

                        svg.append("text").attr("transform", "rotate(-90)").attr("y", 0 - margin).attr("x",0 - (height / 2))
                            .attr("dy", "1em").style("text-anchor", "middle").text("# of Homeruns"); 

                    });

                    console.log("fixed 3");
                </script>  
            </div>

            <div class="annotation">
                <h1>Homeruns</h1>
            </div>
        </div>  
    </body>
</html>
